@{var userName = User?.Identity?.IsAuthenticated == true ? User.Identity!.Name : null;}
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>@ViewData["Title"] - 站点管理系统</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" />
    <link rel="stylesheet" href="/css/theme.css" />

</head>
<body>
    <div class="layout" id="mainLayout">
        <aside class="sidebar">
				<div class="sidebar-toggle" id="sidebarToggle">
					<i class="bi bi-chevron-left"></i>
				</div>
            <div class="brand">
                <!-- 品牌Logo占位：请放置 2048x2048 缩略图路径 -->
                <img class="brand-logo" src="<!-- /img/brand/logo.png -->" alt="logo" />
                <span>站点管理系统</span>
            </div>
            <nav>
                <!-- 工作台 -->
                <div class="nav-section">
                    <div class="nav-section-title">工作台</div>
                    <a class="nav-link" href="/station"><i class="bi bi-speedometer2"></i><span>仪表盘</span></a>
                </div>
                
                <div class="border-t"></div>
                
                <!-- 库存管理 -->
                <div class="nav-section">
                    <div class="nav-section-title">库存管理</div>
                    <a class="nav-link" href="/station/inventory"><i class="bi bi-archive"></i><span>库存列表</span></a>
                    <a class="nav-link" href="/station/products"><i class="bi bi-box-seam"></i><span>产品管理</span></a>
                </div>
                
                <div class="border-t"></div>
                
                <!-- 业务处理 -->
                <div class="nav-section">
                    <div class="nav-section-title">业务处理</div>
                    <a class="nav-link" href="/station/orders"><i class="bi bi-truck"></i><span>配送订单</span></a>
                    <a class="nav-link" href="/station/aftersales"><i class="bi bi-headset"></i><span>售后服务</span></a>
                </div>
            </nav>
        </aside>
        <main class="content">
            <header class="topbar">
                <div class="container-fluid py-2 d-flex justify-content-between align-items-center">
                    <div class="fw-bold">高效管理站点运营</div>
                    <div class="right">
                        @if (userName == null)
                        {
                            <a class="btn btn-sm btn-outline-primary" href="/station/login">登录</a>
                        }
                        else
                        {
                            <!-- 头像占位：站点管理员头像资源路径 -->
                            <img class="avatar" src="<!-- /img/avatar/station.png -->" alt="avatar" />
                            <span class="text-muted">@userName</span>
                            <a class="btn btn-sm btn-outline-secondary" href="/station/logout">退出</a>
                        }
                    </div>
                </div>
            </header>
            <div class="content-inner">
                <!-- 面包屑导航 -->
                <nav aria-label="breadcrumb" class="mb-4">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="/station">首页</a></li>
                        @if (ViewData["ParentTitle"] != null) {
                            <li class="breadcrumb-item"><a href="@ViewData["ParentUrl"]">@ViewData["ParentTitle"]</a></li>
                        }
                        <li class="breadcrumb-item active" aria-current="page">@ViewData["Title"]</li>
                    </ol>
                </nav>
                @RenderBody()
            </div>
        </main>
    </div>
    
    <script>
				// 导航栏展开/关闭功能
				document.addEventListener('DOMContentLoaded', function() {
					const sidebar = document.querySelector('.sidebar');
					const layout = document.getElementById('mainLayout');
					const toggleBtn = document.getElementById('sidebarToggle');
					const toggleIcon = toggleBtn.querySelector('i');
					
					// 从localStorage中恢复导航栏状态
					const isCollapsed = localStorage.getItem('sidebarCollapsed') === 'true';
					if (isCollapsed) {
						sidebar.classList.add('collapsed');
						layout.classList.add('sidebar-collapsed');
						toggleIcon.classList.remove('bi-chevron-left');
						toggleIcon.classList.add('bi-chevron-right');
					}
					
					// 绑定切换事件
					toggleBtn.addEventListener('click', function() {
						const isCurrentlyCollapsed = sidebar.classList.contains('collapsed');
						
						if (isCurrentlyCollapsed) {
							// 展开导航栏
							sidebar.classList.remove('collapsed');
							layout.classList.remove('sidebar-collapsed');
							toggleIcon.classList.remove('bi-chevron-right');
							toggleIcon.classList.add('bi-chevron-left');
							localStorage.setItem('sidebarCollapsed', 'false');
						} else {
							// 收起导航栏
							sidebar.classList.add('collapsed');
							layout.classList.add('sidebar-collapsed');
							toggleIcon.classList.remove('bi-chevron-left');
							toggleIcon.classList.add('bi-chevron-right');
							localStorage.setItem('sidebarCollapsed', 'true');
						}
					});
					
					// 高亮当前活动的导航项
					const currentPath = window.location.pathname;
					document.querySelectorAll('.nav-link').forEach(function(link) {
						const linkPath = link.getAttribute('href');
						if (currentPath === linkPath || (linkPath !== '/' && currentPath.startsWith(linkPath + '/'))) {
							link.classList.add('active');
						}
					});
				});
			</script>
	</body>
</html>